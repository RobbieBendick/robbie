import "./Nav.scss"
import React, {useState, useRef, useEffect} from 'react';
import { Link } from "react-router-dom";
import $ from "jquery";
import {motion} from "framer-motion";
import mobile from "../../hooks/useCheckMobileScreen";

function Nav() {
    const isMobile = mobile();
    const [sidebarIsOpen, setSidebarIsOpen] = useState(false);
    const sidebarWidth = "250px";
    let nav = document.getElementById("mySidenav");

    let menuRef = useRef();
    let menuToggleButtonRef = useRef();

    // "click-out" of dropdown
    useEffect(() => {
        document.addEventListener('mousedown', event => {
            if (!menuRef.current.contains(event.target) && !menuToggleButtonRef.current.contains(event.target)) {
                closeSidebar();
                showNav();
            }
        })
    });

    function closeSidebar() {
        setSidebarIsOpen(false);
        nav.style.width = "0";
    }

    function toggleSidebar() {
        if (sidebarIsOpen) {
            setSidebarIsOpen(false);
            nav.style.width = "0";
        } else {
            setSidebarIsOpen(true);
            nav.style.width = sidebarWidth;
        }
    }

    function hideNav() {
        $("#navbar").removeClass("is-visible").addClass("is-hidden");
    }
    
    function showNav() {
        $("#navbar").removeClass("is-hidden").addClass("is-visible sticky");
    }

    useEffect(() => {
        $(document).ready(function() {

            var previousScroll = 0;
          
            $(window).scroll(function() {
          
              var currentScroll = $(this).scrollTop();
          
              // If the current scroll position is greater than 0 (the top) AND the current scroll position is less than the document height minus the window height (the bottom) run the navigation if/else statement.
              if (currentScroll > 0 && currentScroll < $(document).height() - $(window).height()) {
                // If the current scroll is greater than the previous scroll (i.e we're scrolling down the page), hide the nav.
                if (currentScroll > previousScroll) {
                  window.setTimeout(hideNav, 50);

                  // Else we are scrolling up (i.e the previous scroll is greater than the current scroll), so show the nav.
                } else {
                    window.setTimeout(showNav, 50);
                }
          
                // Set the previous scroll value equal to the current scroll.
                previousScroll = currentScroll;
              }
          
            });
          
    })
})



useEffect(() => {
    if (sidebarIsOpen) {
        document.body.style.overflow = "hidden";
        $("#root > *:not(aside)").css({"filter": "blur(4px)"});
    } else {
        document.body.style.overflow = "inherit";
        $("#root > *:not(aside)").css({"filter": "none"});
    }
}, [sidebarIsOpen])

useEffect(() => {
    if (isMobile) {
        // collapse sidebar if previously opened
        if (document.body.style.overflow === "hidden") {
            document.body.style.overflow = "inherit";
        }
        $("#root > *:not(aside)").css({"filter": "none"});
        $(".sidenav").width(0);        
    }
}, [isMobile])

useEffect(() => {
    if ($(window).scrollTop() === 0) showNav();
})


function AnchorItem({txt, href}) {
    return (
        <li>
            <a onClick={closeSidebar} href={href}>{txt}</a>
        </li>
    )
}
    return (
        <>
            <aside ref={menuRef} id="mySidenav" class="sidenav">
                <a className="closebtn" onClick={() => {
                    closeSidebar();
                    showNav();
                }}>
                    &times;
                </a>
                <AnchorItem txt="About" href="#about"/>
                <AnchorItem txt="Projects" href="#projects"/>
                <AnchorItem txt="Contact" href="#contact"/>
                <a href="/resume" target="_blank" rel="noopener noreferrer">Resume</a>
            </aside>
         
            <nav id="navbar" class="navbar navbar-light sticky">
                <a class="navbar-brand" onClick={() => window.scrollTo(0,0)}>
                    <svg xmlns="http://www.w3.org/2000/svg" width="0.9in" height="0.7in" viewBox="0 0 800 600">
                        <path id="signature" fill="none" stroke="#64ffda" stroke-width="25" d="M 254.00,147.00 C 254.00,146.00 254.29,145.71 255.00,145.00 255.71,144.29 255.62,143.92 256.00,143.00 256.54,141.69 259.00,142.00 260.00,141.00 261.00,140.00 263.05,139.46 265.00,139.00 267.18,138.49 269.00,138.00 271.00,138.00 274.00,138.00 276.00,138.00 279.00,138.00 282.00,138.00 285.05,137.36 289.00,138.00 292.12,138.51 296.13,139.57 300.00,141.00 304.19,142.55 308.13,144.57 312.00,146.00 316.19,147.55 320.08,149.79 323.00,151.00 327.13,152.71 329.76,155.42 333.00,157.00 335.84,158.39 339.21,160.71 342.00,163.00 344.19,164.79 346.52,167.32 348.00,169.00 350.39,171.70 352.35,173.71 354.00,176.00 355.31,177.81 357.00,181.00 358.00,184.00 359.00,187.00 359.85,190.04 361.00,194.00 361.88,197.04 363.50,199.91 364.00,204.00 364.49,207.97 365.00,211.00 366.00,214.00 367.00,217.00 367.00,220.00 367.00,223.00 367.00,225.00 367.00,227.00 367.00,229.00 367.00,232.00 367.32,234.03 367.00,236.00 366.49,239.12 365.12,240.07 364.00,242.00 362.19,245.12 360.48,246.32 359.00,248.00 356.61,250.70 354.19,252.21 352.00,254.00 349.21,256.29 347.07,257.14 345.00,258.00 342.08,259.21 339.04,260.12 336.00,261.00 332.04,262.15 330.04,263.12 327.00,264.00 323.04,265.15 319.99,265.76 318.00,266.00 313.91,266.50 311.12,267.49 308.00,268.00 306.03,268.32 303.00,268.00 300.00,268.00 297.00,268.00 294.00,268.00 291.00,268.00 289.00,268.00 287.00,268.00 285.00,268.00 282.00,268.00 281.00,268.00 279.00,268.00 277.00,268.00 274.92,267.38 274.00,267.00 272.69,266.46 272.31,265.54 271.00,265.00 270.08,264.62 269.38,264.92 269.00,264.00 268.46,262.69 267.31,262.54 266.00,262.00 265.08,261.62 263.41,262.41 262.00,261.00 261.29,260.29 261.00,260.00 261.00,261.00 261.00,262.00 261.00,263.00 261.00,264.00 261.00,265.00 261.00,266.00 261.00,267.00 261.00,268.00 261.00,269.00 261.00,270.00 261.00,271.00 260.62,272.08 261.00,273.00 261.54,274.31 262.49,274.82 263.00,277.00 263.46,278.95 263.46,280.69 264.00,282.00 264.77,283.85 264.00,285.00 264.00,287.00 264.00,289.00 264.49,289.88 265.00,293.00 265.32,294.97 265.54,297.05 266.00,299.00 266.51,301.18 266.85,303.23 268.00,306.00 268.54,307.31 269.26,309.80 270.00,311.00 271.66,313.69 272.00,315.00 273.00,317.00 274.00,319.00 274.92,320.39 276.00,323.00 276.77,324.85 276.69,327.19 278.00,329.00 279.65,331.29 280.00,333.00 281.00,335.00 282.00,337.00 284.26,339.80 285.00,341.00 286.66,343.69 286.69,346.19 288.00,348.00 288.83,349.15 290.69,352.19 292.00,354.00 293.65,356.29 294.69,358.19 296.00,360.00 297.65,362.29 299.19,363.69 301.00,365.00 303.29,366.65 304.80,368.26 306.00,369.00 308.69,370.66 309.82,371.49 312.00,372.00 313.95,372.46 315.00,373.00 317.00,373.00 318.00,373.00 320.15,372.23 322.00,373.00 323.31,373.54 325.00,374.00 327.00,374.00 329.00,374.00 330.00,374.00 331.00,374.00 333.00,374.00 334.00,374.00 335.00,374.00 336.00,374.00 335.62,372.92 336.00,372.00 336.54,370.69 338.00,370.00 339.00,369.00 340.00,368.00 340.29,367.71 341.00,367.00 341.71,366.29 342.29,365.71 343.00,365.00 343.71,364.29 345.46,364.31 346.00,363.00 346.38,362.08 346.62,360.92 347.00,360.00 347.54,358.69 348.46,358.31 349.00,357.00 349.38,356.08 349.62,355.92 350.00,355.00 350.54,353.69 352.00,354.00 352.00,353.00 352.00,352.00 352.46,351.31 353.00,350.00 353.38,349.08 354.00,349.00 354.00,348.00 354.00,347.00 354.00,346.00 355.00,346.00 355.00,346.00 355.00,345.00 355.00,345.00 355.00,345.00 355.00,344.00 355.00,344.00M 256.00,138.00 C 256.00,140.00 256.00,141.00 256.00,142.00 256.00,143.00 256.29,143.29 257.00,144.00 257.71,144.71 257.00,147.00 257.00,148.00 257.00,150.00 257.00,152.00 257.00,153.00 257.00,155.00 256.54,157.05 257.00,159.00 257.51,161.18 258.49,162.82 259.00,165.00 259.46,166.95 259.49,169.88 260.00,173.00 260.32,174.97 261.00,178.00 261.00,181.00 261.00,183.00 261.49,185.88 262.00,189.00 262.48,191.96 262.49,194.88 263.00,198.00 263.48,200.96 263.00,205.00 263.00,208.00 263.00,212.00 263.50,214.91 264.00,219.00 264.49,222.97 264.00,227.00 264.00,230.00 264.00,233.00 264.00,237.00 264.00,241.00 264.00,245.00 264.00,248.00 264.00,252.00 264.00,256.00 264.00,260.00 264.00,264.00 264.00,268.00 264.15,272.04 263.00,276.00 262.12,279.04 261.50,281.91 261.00,286.00 260.63,288.98 259.88,291.96 259.00,295.00 257.85,298.96 257.51,301.88 257.00,305.00 256.52,307.96 256.48,311.04 256.00,314.00 255.49,317.12 254.48,319.04 254.00,322.00 253.49,325.12 253.21,327.08 252.00,330.00 251.14,332.07 249.51,333.82 249.00,336.00 248.54,337.95 248.21,340.08 247.00,343.00 246.14,345.07 246.21,347.08 245.00,350.00 244.14,352.07 243.77,354.15 243.00,356.00 241.92,358.61 239.83,359.85 239.00,361.00 237.69,362.81 237.66,364.31 236.00,367.00 235.26,368.20 233.31,369.19 232.00,371.00 231.17,372.15 230.31,373.19 229.00,375.00 228.17,376.15 227.00,377.00 226.00,378.00 225.00,379.00 223.71,379.29 223.00,380.00 222.29,380.71 221.71,380.29 221.00,381.00 220.29,381.71 220.00,382.00 220.00,383.00 220.00,383.00 219.00,383.00 219.00,383.00 219.00,383.00 219.00,382.00 219.00,382.00M 422.00,350.00 C 423.00,350.00 424.00,350.00 425.00,350.00 426.00,350.00 427.00,350.00 428.00,350.00 429.00,350.00 430.00,350.00 431.00,350.00 432.00,350.00 432.29,349.71 433.00,349.00 433.71,348.29 434.00,348.00 435.00,348.00 436.00,348.00 436.29,347.71 437.00,347.00 437.71,346.29 438.00,346.00 439.00,345.00 440.00,344.00 440.08,343.38 441.00,343.00 442.31,342.46 442.62,341.92 443.00,341.00 443.54,339.69 444.85,339.83 446.00,339.00 447.81,337.69 448.85,337.83 450.00,337.00 451.81,335.69 452.69,335.54 454.00,335.00 455.85,334.23 458.03,334.23 459.00,334.00 461.18,333.49 462.00,332.00 464.00,332.00 466.00,332.00 468.00,331.00 470.00,331.00 472.00,331.00 474.00,331.00 477.00,331.00 479.00,331.00 481.00,331.00 483.00,331.00 485.00,331.00 488.00,331.00 490.00,331.00 492.00,331.00 494.00,331.00 496.00,332.00 498.00,333.00 499.03,333.77 500.00,334.00 502.18,334.51 503.00,336.00 504.00,337.00 505.00,338.00 505.62,338.08 506.00,339.00 506.54,340.31 507.46,340.69 508.00,342.00 508.38,342.92 507.62,344.08 508.00,345.00 508.54,346.31 509.29,346.29 510.00,347.00 511.41,348.41 510.00,350.00 510.00,351.00 510.00,352.00 510.46,352.69 511.00,354.00 511.38,354.92 511.00,356.00 511.00,358.00 511.00,359.00 511.49,359.82 512.00,362.00 512.23,362.97 512.00,364.00 512.00,366.00 512.00,367.00 512.38,368.08 512.00,369.00 511.46,370.31 511.00,371.00 510.00,372.00 509.00,373.00 508.92,373.62 508.00,374.00 506.69,374.54 505.92,375.62 505.00,376.00 503.69,376.54 503.00,378.00 501.00,378.00 500.00,378.00 498.00,379.00 497.00,379.00 495.00,379.00 493.00,379.00 491.00,379.00 488.00,379.00 487.00,379.00 484.00,379.00 482.00,379.00 479.00,379.00 476.00,379.00 474.00,379.00 471.00,379.00 469.00,378.00 467.00,377.00 463.99,376.16 463.00,376.00 459.88,375.49 459.00,374.00 457.00,373.00 455.00,372.00 453.71,371.71 453.00,371.00 452.29,370.29 451.54,369.31 451.00,368.00 450.62,367.08 451.00,366.00 451.00,365.00 451.00,364.00 451.00,363.00 451.00,362.00 451.00,361.00 451.00,360.00 451.00,359.00 451.00,357.00 451.00,356.00 451.00,355.00 451.00,354.00 450.77,351.97 451.00,351.00 451.51,348.82 452.46,347.31 453.00,346.00 453.77,344.15 453.49,343.18 454.00,341.00 454.46,339.05 454.54,337.95 455.00,336.00 455.51,333.82 457.00,332.00 457.00,331.00 457.00,329.00 457.54,327.95 458.00,326.00 458.51,323.82 459.00,323.00 460.00,321.00 461.00,319.00 461.49,318.18 462.00,316.00 462.46,314.05 462.23,312.85 463.00,311.00 463.54,309.69 464.23,307.85 465.00,306.00 465.54,304.69 466.00,303.00 467.00,301.00 468.00,299.00 469.46,298.31 470.00,297.00 470.77,295.15 471.17,293.15 472.00,292.00 473.31,290.19 474.46,289.31 475.00,288.00 475.77,286.15 475.69,284.81 477.00,283.00 477.83,281.85 478.62,279.92 479.00,279.00 480.08,276.39 481.17,276.15 482.00,275.00 483.31,273.19 483.10,271.18 485.00,270.00 485.85,269.47 486.77,268.97 487.00,268.00 487.51,265.82 489.46,266.31 490.00,265.00 490.38,264.08 491.46,263.31 492.00,262.00 492.38,261.08 493.08,261.38 494.00,261.00 495.31,260.46 495.69,259.54 497.00,259.00 497.92,258.62 499.00,259.00 500.00,259.00 501.00,259.00 502.00,259.00 503.00,259.00 504.00,259.00 505.00,259.00 506.00,259.00 507.00,259.00 508.00,259.00 509.00,259.00 510.00,259.00 511.29,258.29 512.00,259.00 512.71,259.71 512.00,261.00 512.00,262.00 512.00,262.00 512.00,263.00 512.00,263.00 512.00,263.00 513.00,263.00 513.00,263.00 513.00,263.00 514.00,263.00 514.00,263.00M 355.00,345.00 C 355.00,344.00 355.00,343.00 356.00,343.00 357.00,343.00 357.08,342.38 358.00,342.00 359.31,341.46 359.29,340.71 360.00,340.00 360.71,339.29 362.29,340.71 363.00,340.00 363.71,339.29 363.69,338.54 365.00,338.00 365.92,337.62 366.69,336.54 368.00,336.00 368.92,335.62 369.29,335.71 370.00,335.00 370.71,334.29 371.29,334.71 372.00,334.00 372.71,333.29 373.69,333.54 375.00,333.00 375.92,332.62 377.08,332.38 378.00,332.00 379.31,331.46 380.00,331.00 381.00,331.00 382.00,331.00 383.00,330.00 384.00,330.00 385.00,330.00 387.00,330.00 388.00,330.00 389.00,330.00 390.00,330.00 391.00,330.00 392.00,330.00 393.00,330.00 395.00,330.00 396.00,330.00 397.00,330.00 398.00,330.00 399.00,330.00 399.69,330.46 401.00,331.00 401.92,331.38 403.08,331.62 404.00,332.00 405.31,332.54 406.29,333.29 407.00,334.00 407.71,334.71 409.08,334.62 410.00,335.00 411.31,335.54 412.29,336.29 413.00,337.00 413.71,337.71 413.69,338.46 415.00,339.00 415.92,339.38 416.46,339.69 417.00,341.00 417.38,341.92 418.00,342.00 418.00,343.00 418.00,344.00 419.29,344.29 420.00,345.00 420.71,345.71 419.62,347.08 420.00,348.00 420.54,349.31 421.00,350.00 421.00,351.00 421.00,352.00 421.00,353.00 421.00,354.00 421.00,355.00 421.00,356.00 421.00,357.00 421.00,358.00 421.00,359.00 421.00,360.00 421.00,361.00 421.31,362.46 420.00,363.00 419.08,363.38 419.71,364.29 419.00,365.00 418.29,365.71 418.71,366.29 418.00,367.00 417.29,367.71 417.00,368.00 416.00,368.00 415.00,368.00 415.31,369.46 414.00,370.00 413.08,370.38 413.00,371.00 412.00,371.00 411.00,371.00 410.71,371.29 410.00,372.00 409.29,372.71 407.41,370.59 406.00,372.00 405.29,372.71 405.31,373.46 404.00,374.00 403.08,374.38 402.00,374.00 401.00,374.00 400.00,374.00 399.00,374.00 398.00,374.00 397.00,374.00 397.00,375.00 396.00,375.00 394.00,375.00 393.00,375.00 392.00,375.00 391.00,375.00 390.00,375.00 389.00,375.00 388.00,375.00 387.92,374.38 387.00,374.00 385.69,373.46 385.00,373.00 384.00,373.00 383.00,373.00 382.00,372.00 381.00,372.00 380.00,372.00 379.97,371.23 379.00,371.00 376.82,370.49 377.00,369.00 376.00,369.00 375.00,369.00 373.71,368.71 373.00,368.00 372.29,367.29 372.00,367.00 371.00,366.00 370.00,365.00 369.71,364.71 369.00,364.00 368.29,363.29 368.71,362.71 368.00,362.00 367.29,361.29 368.71,359.71 368.00,359.00 367.29,358.29 367.00,358.00 367.00,357.00 367.00,356.00 366.00,356.00 366.00,355.00 366.00,354.00 365.00,354.00 365.00,353.00 365.00,352.00 365.00,351.00 365.00,350.00 365.00,349.00 365.00,348.00 365.00,347.00 365.00,346.00 364.00,346.00 364.00,345.00 364.00,344.00 364.00,343.00 364.00,342.00 364.00,341.00 364.00,340.00 364.00,339.00 364.00,339.00 365.00,339.00 365.00,339.00" />
                    </svg>
                </a>
                <div class="" id="navbarNav">
                        {isMobile ?
                        <button class='nav-btn' ref={menuToggleButtonRef} onClick={() => {
                            toggleSidebar();
                            hideNav();
                        }}><i class="fa-solid fa-bars"></i></button>
                        :
                        <ul class="navbar-nav ml-auto">
                            <motion.li class="nav-item active fade-in-1">
                                <a class="nav-link" href="#about">About</a>
                            </motion.li>
                            <li class="nav-item fade-in-2">
                                <a class="nav-link" href="#projects">Projects</a>
                            </li>
                            <li class="nav-item fade-in-3">
                                <a class="nav-link" href="#contact">Contact</a>
                            </li>
                            <li class="nav-item fade-in-4">
                                <motion.a href="/resume" whileHover={{backgroundColor: "rgb(100, 255, 218, 0.1)"}} className="resume-button" target="_blank" rel="noopener noreferrer">Resume</motion.a>
                            </li>   
                        </ul>
                        }
                </div>
            </nav>
        </>
    )
}

export default Nav;